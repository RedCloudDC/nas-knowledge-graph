{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://nas-knowledge-graph.example.com/schemas/graphiti-mapping",
  "title": "Graphiti Mapping Configuration",
  "description": "Configuration for mapping NAS data model to Graphiti knowledge graph constructs",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "Mapping configuration version",
      "default": "1.0.0"
    },
    "nodeTypes": {
      "type": "object",
      "description": "Mapping of node types to Graphiti entities",
      "properties": {
        "Equipment": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Entity"
            },
            "schemaFile": {
              "type": "string",
              "const": "equipment.schema.json"
            },
            "primaryKey": {
              "type": "string",
              "const": "id"
            },
            "displayName": {
              "type": "string",
              "const": "name"
            },
            "indexedFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["id", "name", "type", "category", "operationalStatus", "location"]
            },
            "searchableFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["name", "type", "category", "model", "manufacturer"]
            },
            "typeMapping": {
              "type": "object",
              "properties": {
                "surveillance": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "default": ["radar_short_range", "radar_long_range", "radom"]
                },
                "navigation": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "default": ["vor", "glide_slope", "localizer", "marker_beacon"]
                },
                "weather": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "default": ["asos", "awos", "adas"]
                },
                "communication": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "default": ["tvs", "vscs", "tdm_ethernet"]
                }
              }
            }
          }
        },
        "Location": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Entity"
            },
            "schemaFile": {
              "type": "string",
              "const": "location.schema.json"
            },
            "primaryKey": {
              "type": "string",
              "const": "id"
            },
            "displayName": {
              "type": "string",
              "const": "name"
            },
            "indexedFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["id", "name", "type", "airportCode", "coordinates.latitude", "coordinates.longitude"]
            },
            "searchableFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["name", "type", "airportCode", "address.city", "address.state"]
            },
            "geoSpatialFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["coordinates"]
            }
          }
        },
        "Event": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Entity"
            },
            "schemaFile": {
              "type": "string",
              "const": "event.schema.json"
            },
            "primaryKey": {
              "type": "string",
              "const": "id"
            },
            "displayName": {
              "type": "string",
              "const": "title"
            },
            "indexedFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["id", "type", "severity", "status", "startTime", "endTime"]
            },
            "searchableFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["title", "description", "type", "severity", "tags"]
            },
            "temporalFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["startTime", "endTime", "estimatedEndTime"]
            }
          }
        },
        "Personnel": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Entity"
            },
            "schemaFile": {
              "type": "string",
              "const": "personnel.schema.json"
            },
            "primaryKey": {
              "type": "string",
              "const": "id"
            },
            "displayName": {
              "type": "string",
              "const": "name"
            },
            "indexedFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["id", "employeeId", "role", "department", "status", "homeLocation"]
            },
            "searchableFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["name.first", "name.last", "role", "department", "expertiseAreas"]
            },
            "sensitiveFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["contactInfo", "securityClearance", "performanceMetrics"]
            }
          }
        },
        "Report": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Entity"
            },
            "schemaFile": {
              "type": "string",
              "const": "report.schema.json"
            },
            "primaryKey": {
              "type": "string",
              "const": "id"
            },
            "displayName": {
              "type": "string",
              "const": "title"
            },
            "indexedFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["id", "type", "status", "classification", "createdBy", "createdDate"]
            },
            "searchableFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["title", "summary", "content", "tags", "type"]
            },
            "fullTextFields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["content.background", "content.findings", "content.recommendations"]
            }
          }
        }
      }
    },
    "relationshipTypes": {
      "type": "object",
      "description": "Mapping of relationship types to Graphiti edges",
      "properties": {
        "LOCATED_AT": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Edge"
            },
            "sourceTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Equipment"]
            },
            "targetTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Location"]
            },
            "cardinality": {
              "type": "string",
              "enum": ["one-to-one", "one-to-many", "many-to-one", "many-to-many"],
              "default": "many-to-one"
            },
            "direction": {
              "type": "string",
              "enum": ["directed", "undirected"],
              "default": "directed"
            }
          }
        },
        "ASSIGNED_TO": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Edge"
            },
            "sourceTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Personnel"]
            },
            "targetTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Event"]
            },
            "cardinality": {
              "type": "string",
              "default": "many-to-many"
            },
            "temporalProperties": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["startDate", "endDate", "duration"]
            }
          }
        },
        "EXPERIENCED_OUTAGE": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Edge"
            },
            "sourceTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Equipment"]
            },
            "targetTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Event"]
            },
            "cardinality": {
              "type": "string",
              "default": "many-to-many"
            }
          }
        },
        "GENERATED_REPORT": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Edge"
            },
            "sourceTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Event"]
            },
            "targetTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Report"]
            },
            "cardinality": {
              "type": "string",
              "default": "one-to-many"
            }
          }
        },
        "CONTAINS_LESSONS": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Edge"
            },
            "sourceTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Report"]
            },
            "targetTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Report"]
            },
            "cardinality": {
              "type": "string",
              "default": "many-to-many"
            }
          }
        },
        "DEPENDS_ON": {
          "type": "object",
          "properties": {
            "graphitiType": {
              "type": "string",
              "const": "Edge"
            },
            "sourceTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Equipment"]
            },
            "targetTypes": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["Equipment"]
            },
            "cardinality": {
              "type": "string",
              "default": "many-to-many"
            },
            "weightedProperties": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["weight", "strength", "impact"]
            }
          }
        }
      }
    },
    "graphitiConfiguration": {
      "type": "object",
      "description": "Graphiti-specific configuration settings",
      "properties": {
        "embedding": {
          "type": "object",
          "properties": {
            "model": {
              "type": "string",
              "default": "text-embedding-ada-002"
            },
            "dimensions": {
              "type": "integer",
              "default": 1536
            },
            "fields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": ["name", "description", "title", "content", "summary"]
            }
          }
        },
        "indexing": {
          "type": "object",
          "properties": {
            "vectorIndex": {
              "type": "boolean",
              "default": true
            },
            "fullTextIndex": {
              "type": "boolean",
              "default": true
            },
            "geoSpatialIndex": {
              "type": "boolean",
              "default": true
            },
            "temporalIndex": {
              "type": "boolean",
              "default": true
            }
          }
        },
        "queries": {
          "type": "object",
          "properties": {
            "semanticSearch": {
              "type": "boolean",
              "default": true
            },
            "pathFinding": {
              "type": "boolean",
              "default": true
            },
            "clustering": {
              "type": "boolean",
              "default": true
            },
            "temporalQueries": {
              "type": "boolean",
              "default": true
            },
            "spatialQueries": {
              "type": "boolean",
              "default": true
            }
          }
        },
        "constraints": {
          "type": "object",
          "properties": {
            "uniqueConstraints": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "nodeType": {
                    "type": "string"
                  },
                  "field": {
                    "type": "string"
                  }
                }
              },
              "default": [
                {"nodeType": "Equipment", "field": "id"},
                {"nodeType": "Location", "field": "id"},
                {"nodeType": "Event", "field": "id"},
                {"nodeType": "Personnel", "field": "id"},
                {"nodeType": "Report", "field": "id"}
              ]
            },
            "referentialIntegrity": {
              "type": "boolean",
              "default": true
            }
          }
        }
      }
    },
    "validation": {
      "type": "object",
      "description": "Validation rules for graph construction",
      "properties": {
        "nodeValidation": {
          "type": "boolean",
          "default": true,
          "description": "Validate nodes against their JSON schemas"
        },
        "relationshipValidation": {
          "type": "boolean",
          "default": true,
          "description": "Validate relationships against allowed source/target combinations"
        },
        "crossReferences": {
          "type": "boolean",
          "default": true,
          "description": "Validate that referenced IDs exist"
        },
        "temporalConsistency": {
          "type": "boolean",
          "default": true,
          "description": "Validate temporal relationships (e.g., start < end)"
        }
      }
    }
  },
  "additionalProperties": false
}
