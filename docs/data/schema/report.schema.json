{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://nas-knowledge-graph.example.com/schemas/report",
  "title": "Report Node Schema",
  "description": "Schema for report nodes including action reports, lessons learned, and analysis documents",
  "type": "object",
  "required": ["id", "type", "title", "status", "createdBy", "createdDate"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for the report",
      "pattern": "^RPT[0-9]{6}$"
    },
    "type": {
      "type": "string",
      "enum": [
        "action_report",
        "lessons_learned",
        "incident_analysis",
        "safety_assessment",
        "maintenance_summary",
        "trend_analysis",
        "performance_review",
        "inspection_report",
        "technical_evaluation",
        "cost_analysis",
        "compliance_audit",
        "risk_assessment"
      ],
      "description": "Type of report or document"
    },
    "title": {
      "type": "string",
      "description": "Report title or subject",
      "minLength": 1,
      "maxLength": 200
    },
    "status": {
      "type": "string",
      "enum": [
        "draft",
        "under_review",
        "approved",
        "published",
        "archived",
        "superseded"
      ],
      "description": "Current status of the report"
    },
    "classification": {
      "type": "string",
      "enum": [
        "public",
        "internal",
        "restricted",
        "confidential"
      ],
      "description": "Security classification of the report",
      "default": "internal"
    },
    "summary": {
      "type": "string",
      "description": "Executive summary or abstract",
      "maxLength": 1000
    },
    "content": {
      "type": "object",
      "description": "Main report content sections",
      "properties": {
        "background": {
          "type": "string",
          "description": "Background information and context",
          "maxLength": 5000
        },
        "methodology": {
          "type": "string",
          "description": "Analysis methodology or approach used",
          "maxLength": 2000
        },
        "findings": {
          "type": "array",
          "description": "Key findings or observations",
          "items": {
            "type": "object",
            "properties": {
              "title": {
                "type": "string",
                "maxLength": 200
              },
              "description": {
                "type": "string",
                "maxLength": 1000
              },
              "severity": {
                "type": "string",
                "enum": ["critical", "high", "medium", "low", "informational"]
              },
              "category": {
                "type": "string",
                "maxLength": 100
              }
            }
          }
        },
        "recommendations": {
          "type": "array",
          "description": "Recommendations for action",
          "items": {
            "type": "object",
            "properties": {
              "title": {
                "type": "string",
                "maxLength": 200
              },
              "description": {
                "type": "string",
                "maxLength": 1000
              },
              "priority": {
                "type": "string",
                "enum": ["critical", "high", "medium", "low"]
              },
              "timeline": {
                "type": "string",
                "maxLength": 100
              },
              "assignedTo": {
                "type": "string",
                "pattern": "^PER[0-9]{6}$"
              },
              "estimatedCost": {
                "type": "number",
                "minimum": 0
              }
            }
          }
        },
        "lessonsLearned": {
          "type": "array",
          "description": "Key lessons learned from the analysis",
          "items": {
            "type": "object",
            "properties": {
              "lesson": {
                "type": "string",
                "maxLength": 500
              },
              "applicability": {
                "type": "string",
                "enum": ["specific", "departmental", "organizational", "industry-wide"]
              },
              "category": {
                "type": "string",
                "enum": [
                  "process_improvement",
                  "safety_enhancement",
                  "technical_solution",
                  "training_need",
                  "policy_change",
                  "resource_allocation"
                ]
              }
            }
          }
        }
      }
    },
    "relatedEvents": {
      "type": "array",
      "description": "Events referenced or analyzed in this report",
      "items": {
        "type": "string",
        "pattern": "^EVT[0-9]{6}$"
      },
      "uniqueItems": true
    },
    "relatedEquipment": {
      "type": "array",
      "description": "Equipment discussed or analyzed in this report",
      "items": {
        "type": "string",
        "pattern": "^EQ[0-9]{6}$"
      },
      "uniqueItems": true
    },
    "relatedPersonnel": {
      "type": "array",
      "description": "Personnel mentioned or involved in the report",
      "items": {
        "type": "string",
        "pattern": "^PER[0-9]{6}$"
      },
      "uniqueItems": true
    },
    "relatedLocations": {
      "type": "array",
      "description": "Locations covered or mentioned in the report",
      "items": {
        "type": "string",
        "pattern": "^LOC[0-9]{6}$"
      },
      "uniqueItems": true
    },
    "createdBy": {
      "type": "string",
      "description": "Personnel ID of the report author",
      "pattern": "^PER[0-9]{6}$"
    },
    "reviewedBy": {
      "type": "array",
      "description": "Personnel IDs of report reviewers",
      "items": {
        "type": "string",
        "pattern": "^PER[0-9]{6}$"
      },
      "uniqueItems": true
    },
    "approvedBy": {
      "type": "string",
      "description": "Personnel ID of the approving authority",
      "pattern": "^PER[0-9]{6}$"
    },
    "createdDate": {
      "type": "string",
      "format": "date",
      "description": "Date the report was created"
    },
    "reviewDate": {
      "type": "string",
      "format": "date",
      "description": "Date the report was reviewed"
    },
    "approvalDate": {
      "type": "string",
      "format": "date",
      "description": "Date the report was approved"
    },
    "publishDate": {
      "type": "string",
      "format": "date",
      "description": "Date the report was published"
    },
    "expiryDate": {
      "type": "string",
      "format": "date",
      "description": "Date when report becomes obsolete (if applicable)"
    },
    "version": {
      "type": "string",
      "description": "Report version number",
      "pattern": "^[0-9]+\\.[0-9]+$"
    },
    "tags": {
      "type": "array",
      "description": "Categorization and search tags",
      "items": {
        "type": "string",
        "maxLength": 50
      },
      "uniqueItems": true
    },
    "distribution": {
      "type": "object",
      "description": "Report distribution information",
      "properties": {
        "distributionList": {
          "type": "array",
          "description": "Personnel IDs for distribution",
          "items": {
            "type": "string",
            "pattern": "^PER[0-9]{6}$"
          },
          "uniqueItems": true
        },
        "departments": {
          "type": "array",
          "description": "Departments that should receive this report",
          "items": {
            "type": "string",
            "enum": [
              "maintenance",
              "operations",
              "safety",
              "engineering",
              "quality_assurance",
              "management",
              "training",
              "contractor_services"
            ]
          },
          "uniqueItems": true
        },
        "externalAgencies": {
          "type": "array",
          "description": "External agencies that should receive this report",
          "items": {
            "type": "string",
            "maxLength": 100
          }
        }
      }
    },
    "attachments": {
      "type": "array",
      "description": "Supporting documents and attachments",
      "items": {
        "type": "object",
        "properties": {
          "filename": {
            "type": "string",
            "maxLength": 255
          },
          "description": {
            "type": "string",
            "maxLength": 500
          },
          "fileType": {
            "type": "string",
            "maxLength": 50
          },
          "fileSize": {
            "type": "integer",
            "minimum": 0,
            "description": "File size in bytes"
          },
          "checksum": {
            "type": "string",
            "maxLength": 128
          }
        }
      }
    },
    "followUpActions": {
      "type": "array",
      "description": "Required follow-up actions from this report",
      "items": {
        "type": "object",
        "properties": {
          "action": {
            "type": "string",
            "maxLength": 500
          },
          "assignedTo": {
            "type": "string",
            "pattern": "^PER[0-9]{6}$"
          },
          "dueDate": {
            "type": "string",
            "format": "date"
          },
          "status": {
            "type": "string",
            "enum": ["pending", "in_progress", "completed", "overdue", "cancelled"]
          },
          "priority": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low"]
          }
        }
      }
    },
    "metrics": {
      "type": "object",
      "description": "Report-specific metrics and measurements",
      "properties": {
        "pageCount": {
          "type": "integer",
          "minimum": 1
        },
        "wordCount": {
          "type": "integer",
          "minimum": 0
        },
        "readingTime": {
          "type": "integer",
          "minimum": 0,
          "description": "Estimated reading time in minutes"
        },
        "distributionCount": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of recipients"
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Record creation timestamp"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Record last update timestamp"
        },
        "version": {
          "type": "string",
          "description": "Schema version"
        }
      }
    }
  },
  "additionalProperties": false
}
